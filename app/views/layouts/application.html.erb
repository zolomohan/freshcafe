<!DOCTYPE html>
<html>
  <head>
    <title>Freshcafe</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <!-- Semantic UI -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css" integrity="sha512-8bHTC73gkZ7rZ7vpqUQThUDhqcNFyYi2xgDgPDHc+GXVGHXq+xPjynxIopALmOPqzo9JZj0k6OqqewdGO3EsrQ==" crossorigin="anonymous" />
    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.js" integrity="sha512-dqw6X88iGgZlTsONxZK9ePmJEFrmHwpuMrsUChjAw1mRUhUITE5QU9pkcSox+ynfLhL15Sv2al5A0LVyDCmtUw==" crossorigin="anonymous"></script>
    
    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
    
    <script src="https://kit.fontawesome.com/770ca4bfb4.js" crossorigin="anonymous"></script>

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;400;700&display=swap" rel="stylesheet">

    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_pack_tag 'application', 'data-turbolinks-track': 'reload' %>
  </head>

  <body>
    <%= render 'layouts/sidenav' %>
    
    <div class="main">
      <div class="px-5">
        <% if flash[:list] %>
          <div class="ui message transition mt-4">
            <div class="header">
              Something went Wrong!
            </div>
          <i class="close icon me-2"></i>
            <ul class="list">
              <% flash[:list].each do |msg| %>
                <li>
                  <%= msg %>
                </li>
              <% end %>
            </ul>
          </div>
          
        <% end %>
        <% if notice %>
        <div class="ui message transition mt-4">
          <i class="close icon me-2"></i>
          <div class="header">
            Notice
          </div>
          <p><%= notice %></p>
        </div>
        <% end %>
        <%= yield %>
      </div>
    </div>
    <% if user_signed_in? %>
      <%= render 'layouts/cart_panel' %>
    <% end %>

   
  </body>
  <script>
    const openPanel = () => {
      $(".panel").css('height', '700px');
      $("#items").removeClass('d-none');
      $("#panel-footer").removeClass('d-none');
      $("#checkout-button").removeClass('d-none');
      $('#toggle-panel').removeClass('fa-chevron-up');
      $('#toggle-panel').addClass('fa-chevron-down');
    }

    const closePanel = () => {
      $(".panel").css('height', '70px');
      $("#items").addClass('d-none');
      $("#panel-footer").addClass('d-none');
      $("#checkout-button").addClass('d-none');
      $('#toggle-panel').addClass('fa-chevron-up');
      $('#toggle-panel').removeClass('fa-chevron-down');
    }

    $('.panel .header').click(() => {
      let is_panel_minimized = $(".panel").css('height') === "70px";
      is_panel_minimized ? openPanel() : closePanel();
    })

    $('#toggle-panel').click(() => {
      let is_panel_minimized = $(".panel").css('height') === "70px";
      is_panel_minimized ? openPanel() : closePanel();
    })

    $('.message .close')
    .on('click', function() {
      $(this)
        .closest('.message')
        .transition('fade')
      ;
    })
  ;
  </script>
</html>
